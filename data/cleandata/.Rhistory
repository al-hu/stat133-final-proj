setwd("/Users/Nicole/Desktop/stat133-final-proj/data/cleandata")
library(ggplot2)
library(scales)
# data from repository
roster_salary_stats <- read.csv("roster-salary-stats.csv")
# convert column 'Number' to factor in order to compute the freq
# for each number
factorized <- as.factor(roster_salary_stats$Number)
roster_salary_stats$Number <- factorized
# convert column 'Birth.Date' to date format
date_format <- as.Date(roster_salary_stats$Birth.Date)
roster_salary_stats$Birth.Date <- date_format
# =========================================================================
# Calculate summary statistics for variables
# =========================================================================
# calculate summary statistics to each variable excluding
# the first column
lapply(roster_salary_stats[2:38], summary)
# redirect output to 'cleandata' directory
sink(file = 'eda-output.txt', append = TRUE)
# =========================================================================
# Produce barcharts, box-plots and histograms
# =========================================================================
# extract a dataframe called 'qual_df' containing only
# qualitative variables
qual_df <- Filter(is.factor, roster_salary_stats[3:38])
# extract the column names of qualitative variables
qual_colnames <- names(qual_df)
# loop over each qualitative variable to produce multiple barcharts
# and save them as separate pdf files
for(i in qual_colnames) {
# produce multiple pdf files in specific file names
pdf(paste("../../images/", i, "_barchart.pdf", sep = ""))
# plot barcharts with x axis as names of the qualitative
# variables
barcharts <- ggplot(roster_salary_stats,
aes_string(x = i)) +
geom_bar() +
# add titles and change axis labels
labs(title = paste("Frequency of", i, sep = " "),
x = paste(i),
y = "frequency") +
# rescale y axis
scale_y_continuous(breaks = pretty_breaks(n = 15)) +
# rotate x axis label for 45 degrees
theme(axis.text.x = element_text(angle = 45,
hjust = 1))
plot(barcharts)
dev.off()
}
# extract a dataframe called 'quan_df' containing only
# quantitative variables
quan_df <- Filter(is.numeric, roster_salary_stats[3:38])
# extract the column names of quantitative variables
quan_colnames <- names(quan_df)
# loop over each quantitative variable to create multiple boxplots
# and save them as separate pdf files
for (i in quan_colnames) {
# produce multiple pdf files in specific file names
pdf(paste("../../images/", i, "_boxplot.pdf", sep = ""))
# plot boxplots with x axis as names of teams and y ais as
# names of quantitative variables
boxplots <- ggplot(roster_salary_stats,
aes_string(x = roster_salary_stats$Team,
y = i)) +
geom_boxplot() +
# add titles and change axis labels
labs(title = paste("Box Plot of", i,
"(by Team)", sep = " "),
x = "Team") +
# rescale y axis
scale_y_continuous(breaks =
pretty_breaks(n = 15)) +
# rotate x axis labels for 30 degrees
theme(axis.text.x = element_text(angle = 30,
hjust = 1))
plot(boxplots)
dev.off()
}
